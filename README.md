# 5.3. Введение. Экосистема. Архитектура. Жизненный цикл Docker контейнера

## Задача1

Код : 

```
$ docker run -p -dit 8081:80 nginx:latest
$ docker exec -it 107d742b91cb bash
root@107d742b91cb:/# find -name "index.html"
root@107d742b91cb:/# echo "<html>
<head>
Hey, Netology
</head>
<body>
<h1>I’m DevOps Engineer</h1>
</body>
</html>" > /usr/share/nginx/html/index.html
root@107d742b91cb:/# exit
$ curl 127.0.0.1:8081
<html>
<head>
Hey, Netology
</head>
<body>
<h1>I’m DevOps Engineer</h1>
</body>
</html>

$ docker tag nginx:latest ust022/devops-netology:test
$ docker push ust022/devops-netology:test
```

## Задача 2

Посмотрите на сценарий ниже и ответьте на вопрос: "Подходит ли в этом сценарии использование Docker контейнеров или лучше подойдет виртуальная машина, физическая машина? Может быть возможны разные варианты?"

- Высоконагруженное монолитное java веб-приложение;

Физическая машина, т.к. нагрузка высокая, нужен прямой доступ к аппаратным ресурсам. 

- Nodejs веб-приложение;

Docker, т.к. ограничений для его использования нет, а выполнить запуск приложения в docker проще и быстрее. 

- Мобильное приложение c версиями для Android и iOS;

Виртуальная машина, т.к. для мобильного приложения необходим веб-интерфейс, варианты запуска с GUI в docker есть, но не для этого он создан.

- Шина данных на базе Apache Kafka;

Виртуальная машина, легче выполнить бэкап, хотя для теста можно использовать контейнер. 

- Elasticsearch кластер для реализации логирования продуктивного веб-приложения - три ноды elasticsearch, два logstash и две ноды kibana;

Виртуалка, для Elasticsearch используя несколько хостов (кластер) для отказоустойчивости, logstash и kibana можно и на виртуалке и в docker.

- Мониторинг-стек на базе Prometheus и Grafana;

Ограничений для dockera нет, поэтому проще контейнер. 

- MongoDB, как основное хранилище данных для java-приложения;

БД - поэтому либо виртуалка либо физический сервер, но лучше виртуалку. 

- Gitlab сервер для реализации CI/CD процессов и приватный (закрытый) Docker Registry.

Виртуалка, для бэкапа сервера. 


## Задача 3


- Запустите первый контейнер из образа centos c любым тэгом в фоновом режиме, подключив папку /data из текущей рабочей директории на хостовой машине в /data контейнера;

```
$ docker run -dit -v /data:/data  centos:latest
```

- Запустите второй контейнер из образа debian в фоновом режиме, подключив папку /data из текущей рабочей директории на хостовой машине в /data контейнера;

```
$ docker run -dit -v /data:/data  debian:latest

```

- Подключитесь к первому контейнеру с помощью docker exec и создайте текстовый файл любого содержания в /data;
```
$ docker exec -it 5e0b930f3d73 bash
[root@5e0b930f3d73 /]# echo "File in data" > /data/centos_docker_file.txt
```

- Добавьте еще один файл в папку /data на хостовой машине;

```
echo "File #2" > /data/hostVm_file
```

- Подключитесь во второй контейнер и отобразите листинг и содержание файлов в /data контейнера.

```
$ docker exec -it 4a4e2d1513f4 bash
root@4a4e2d1513f4:/# ls -l /data/
total 8
-rw-r--r-- 1 root root 13 Sep  4 12:50 centos_docker_file.txt
-rw-r--r-- 1 root root  8 Sep  4 12:50 hostVm_file

```

